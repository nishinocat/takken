<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>COMBO問題の分析</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .analysis { background: #f0f0f0; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .problem { color: red; font-weight: bold; }
        .solution { color: green; font-weight: bold; }
    </style>
</head>
<body>
    <h1>COMBOが表示されない問題の分析</h1>
    
    <div class="analysis">
        <h2>考えられる原因：</h2>
        
        <h3 class="problem">1. ストリークがリセットされている</h3>
        <ul>
            <li>アプリ起動時に streak = 0 になる</li>
            <li>問題表示時にリセットされる</li>
            <li>モード切り替え時にリセットされる</li>
        </ul>
        
        <h3 class="problem">2. checkAnswer関数が正しく動作していない</h3>
        <ul>
            <li>isCorrect の判定が常に false</li>
            <li>app.currentQuestion.answer が undefined</li>
            <li>userAnswer と answer の型が一致しない（文字列 vs ブール値）</li>
        </ul>
        
        <h3 class="problem">3. 表示の問題</h3>
        <ul>
            <li>resultDiv.textContent が上書きされている</li>
            <li>CSSで非表示になっている</li>
            <li>他の処理で内容が消されている</li>
        </ul>
    </div>
    
    <div class="analysis">
        <h2>デバッグ手順：</h2>
        <ol>
            <li>ブラウザでindex.htmlを開く</li>
            <li>F12で開発者コンソールを開く</li>
            <li>コンソールに以下を入力：<br>
                <code>console.log('app.streak:', app.streak)</code><br>
                <code>console.log('app.currentQuestion:', app.currentQuestion)</code>
            </li>
            <li>問題に正解する</li>
            <li>コンソールの「=== COMBO DEBUG ===」を確認</li>
        </ol>
    </div>
    
    <div class="analysis">
        <h2 class="solution">最も可能性が高い原因：</h2>
        <p><strong>app.currentQuestion.answer がブール値なのに、checkAnswer に文字列 'true' が渡されている</strong></p>
        
        <h3>確認方法：</h3>
        <p>コンソールで以下を実行：</p>
        <code>
            console.log('Question answer type:', typeof app.currentQuestion.answer);<br>
            console.log('Question answer value:', app.currentQuestion.answer);
        </code>
        
        <h3>もし answer が boolean なら：</h3>
        <p>checkAnswer(true) または checkAnswer(false) を直接呼ぶ必要がある</p>
    </div>
</body>
</html>